<bootstrap_workflow>
  <command_overview>
    The Bootstrap command has exactly two workflow paths:
    1) Initial Bootstrap: Extract project knowledge from codebase for first-time setup
    2) Knowledge Verification: Validate existing bootstrap artifacts against current codebase reality
    
    Outputs are designed to guide AI agents with project-specific knowledge:
    - Capture architecture patterns and design decisions with rationale
    - Surface conventions, constraints, and trade-offs
    - Provide troubleshooting playbooks (symptoms → causes → fixes → prevention)
    - Document anti-patterns and what to avoid
    - Extract integration patterns and external dependencies
    
    This command does not generate user-facing documentation; it produces AI agent guidance artifacts.
  </command_overview>

  <initialization_phase>
    <step number="1">
      <title>Parse Request</title>
      <actions>
        <action>Identify the bootstrap operation requested (extract vs. verify).</action>
        <action>Determine scope: full codebase or specific areas (architecture, conventions, integrations).</action>
        <action>For initial bootstrap: prepare to analyze entire codebase systematically.</action>
        <action>For verification: identify existing bootstrap artifacts to validate.</action>
        <action>Note any specific areas to emphasize or check.</action>
      </actions>
    </step>

    <step number="2">
      <title>Discover Project Structure</title>
      <actions>
        <action>Analyze project directory structure and organization patterns.</action>
        <action>Identify technology stack from package manifests and configuration files.</action>
        <action>Locate key architectural components and service boundaries.</action>
        <action>Map entry points and critical workflows.</action>
        <action>Identify existing documentation in sdlc/ and .roo/ directories.</action>
      </actions>
    </step>
  </initialization_phase>

  <analysis_focus>
    <area>Architecture patterns and component organization</area>
    <area>Technology stack rationale and framework usage</area>
    <area>Code organization conventions and module boundaries</area>
    <area>Error handling and logging patterns</area>
    <area>Testing strategies and coverage expectations</area>
    <area>Configuration management and environment setup</area>
    <area>API design patterns and integration approaches</area>
    <area>Security patterns and authentication flows</area>
    <area>Performance patterns and optimization strategies</area>
    <area>Common pitfalls and anti-patterns (what to avoid and why)</area>
    <area>Decision rationale and trade-offs that affect implementation choices</area>
    <area>Team conventions (naming, git workflow, code review)</area>
    <area>External dependencies and integration patterns</area>
    <area>Data flow and state management patterns</area>
  </analysis_focus>

  <workflow_paths>
    <path name="initial_bootstrap">
      <title>Initial Bootstrap: Extract Project Knowledge</title>
      <description>Systematically analyze codebase to extract project-specific knowledge for AI agent guidance.</description>
      <steps>
        <step number="1">
          <title>Architecture Analysis</title>
          <actions>
            <action>Identify architectural pattern (MVC, microservices, event-driven, layered, etc.).</action>
            <action>Map major components and their responsibilities.</action>
            <action>Document service boundaries and communication patterns.</action>
            <action>Extract design decisions and their rationale from code structure.</action>
            <action>Identify critical data flows and state management.</action>
          </actions>
        </step>
        
        <step number="2">
          <title>Technology Stack Analysis</title>
          <actions>
            <action>Extract technology choices from package manifests.</action>
            <action>Document framework versions and compatibility requirements.</action>
            <action>Identify key libraries and their usage patterns.</action>
            <action>Note build tools, test frameworks, and development dependencies.</action>
            <action>Document rationale for technology choices where evident.</action>
          </actions>
        </step>
        
        <step number="3">
          <title>Convention Extraction</title>
          <actions>
            <action>Analyze naming conventions across codebase (files, functions, variables).</action>
            <action>Extract file organization patterns and directory structure conventions.</action>
            <action>Document code style patterns (formatting, structure, comments).</action>
            <action>Identify git workflow conventions from branch names and commit messages.</action>
            <action>Extract testing conventions and patterns.</action>
          </actions>
        </step>
        
        <step number="4">
          <title>Pattern Discovery</title>
          <actions>
            <action>Identify recurring error handling patterns with examples.</action>
            <action>Extract API integration patterns and client implementations.</action>
            <action>Document data validation and sanitization approaches.</action>
            <action>Identify logging and monitoring patterns.</action>
            <action>Extract configuration management patterns.</action>
            <action>Document authentication and authorization patterns.</action>
          </actions>
        </step>
        
        <step number="5">
          <title>Anti-Pattern Identification</title>
          <actions>
            <action>Identify code smells and anti-patterns to avoid.</action>
            <action>Document why certain approaches are avoided.</action>
            <action>Provide correct alternatives with examples.</action>
            <action>Note common mistakes and how to prevent them.</action>
          </actions>
        </step>
        
        <step number="6">
          <title>Integration Analysis</title>
          <actions>
            <action>Document external API integrations and client patterns.</action>
            <action>Extract database access patterns and ORM usage.</action>
            <action>Identify messaging/queue integration patterns.</action>
            <action>Document authentication mechanisms for external services.</action>
            <action>Note retry, timeout, and circuit breaker patterns.</action>
          </actions>
        </step>
        
        <step number="7">
          <title>Generate Bootstrap Artifacts</title>
          <actions>
            <action>Create sdlc/docs/code/BOOTSTRAP-[project].md with comprehensive project knowledge.</action>
            <action>Generate sdlc/docs/code/patterns.md with recurring code patterns and examples.</action>
            <action>Create sdlc/docs/code/conventions.md with team standards and practices.</action>
            <action>Generate sdlc/docs/code/anti-patterns.md with things to avoid.</action>
            <action>Create sdlc/docs/specs/architecture-decisions.md with ADRs and rationale.</action>
            <action>Generate sdlc/docs/code/troubleshooting-playbook.md with common issues and fixes.</action>
            <action>Update sdlc/docs/code/README.md and sdlc/docs/specs/README.md to reference new artifacts.</action>
          </actions>
          <output_format>
            sdlc/docs/code/BOOTSTRAP-[project].md structure:
            - Executive summary of project architecture
            - Technology stack with rationale
            - Architecture patterns and component organization
            - Code organization conventions with examples
            - Common patterns (DO/DON'T examples from actual code)
            - Anti-patterns to avoid with rationale
            - Integration patterns and external dependencies
            - Configuration management approach
            - Testing strategy and conventions
            - Git workflow and team conventions
            - Troubleshooting playbook (symptoms → causes → fixes → prevention)
            - Decision rationale and trade-offs
            
            Additional artifacts in sdlc/docs/code/:
            - patterns.md - Detailed pattern documentation with examples
            - conventions.md - Team conventions and standards
            - anti-patterns.md - Anti-patterns to avoid with correct alternatives
            - troubleshooting-playbook.md - Common issues and solutions
            
            Additional artifacts in sdlc/docs/specs/:
            - architecture-decisions.md - ADRs and design rationale
          </output_format>
        </step>
      </steps>
    </path>

    <path name="verification">
      <title>Knowledge Verification: Validate Bootstrap Artifacts</title>
      <description>Check existing bootstrap artifacts against current codebase reality.</description>
      <steps>
        <step number="1">
          <title>Analyze Existing Artifacts</title>
          <actions>
            <action>Read existing bootstrap artifacts from sdlc/docs/code/ and sdlc/docs/specs/.</action>
            <action>Parse documented patterns, conventions, and anti-patterns.</action>
            <action>Extract claims about architecture, technology stack, and workflows.</action>
            <action>Note documented integration patterns and dependencies.</action>
          </actions>
        </step>
        
        <step number="2">
          <title>Verify Against Current Codebase</title>
          <actions>
            <action>Check architecture claims against actual code structure.</action>
            <action>Verify technology versions and dependencies are current.</action>
            <action>Validate documented patterns still match implementation.</action>
            <action>Confirm conventions are consistently followed in recent code.</action>
            <action>Check integration patterns match current implementations.</action>
            <action>Identify drift between documented and actual practices.</action>
          </actions>
        </step>
        
        <step number="3">
          <title>Create Verification Report</title>
          <actions>
            <action>Categorize findings by severity (Critical, Major, Minor).</action>
            <action>List outdated patterns with current implementations.</action>
            <action>Identify missing important patterns or conventions.</action>
            <action>Note new anti-patterns that have emerged.</action>
            <action>Provide specific corrections and update recommendations.</action>
            <action>Create VERIFICATION-bootstrap.md with findings.</action>
          </actions>
          <output_format>
            - Verification summary (Current/Needs Updates/Significant Drift)
            - Critical inaccuracies that could mislead AI agents
            - Outdated patterns and their current implementations
            - Missing patterns and conventions from recent development
            - New anti-patterns to document
            - Technology stack updates needed
            - Recommendations for artifact updates
            - Suggested re-extraction areas
          </output_format>
        </step>
      </steps>
    </path>
  </workflow_paths>

  <completion_criteria>
    <for_initial_bootstrap>
      <criterion>Architecture and technology stack documented with rationale</criterion>
      <criterion>Code organization conventions extracted with examples</criterion>
      <criterion>Common patterns documented with DO/DON'T guidance</criterion>
      <criterion>Anti-patterns identified with correct alternatives</criterion>
      <criterion>Integration patterns and external dependencies documented</criterion>
      <criterion>Team conventions and workflows captured</criterion>
      <criterion>Troubleshooting playbook created</criterion>
      <criterion>Bootstrap artifacts generated in sdlc/docs/code/ and sdlc/docs/specs/</criterion>
      <criterion>AI agent guidance files created and README files updated</criterion>
    </for_initial_bootstrap>
    
    <for_verification>
      <criterion>All bootstrap artifacts validated against current code</criterion>
      <criterion>Drift and inaccuracies identified</criterion>
      <criterion>Missing patterns and conventions noted</criterion>
      <criterion>Update recommendations provided</criterion>
      <criterion>Clear verification report created</criterion>
    </for_verification>
  </completion_criteria>

  <integration_with_modes>
    <principle>Bootstrap artifacts serve as foundational knowledge for all SDLC modes</principle>
    <usage>
      <mode>Architect</mode>
      <integration>References bootstrap patterns when designing new features</integration>
    </usage>
    <usage>
      <mode>Code</mode>
      <integration>Follows bootstrap conventions and patterns during implementation</integration>
    </usage>
    <usage>
      <mode>Spec</mode>
      <integration>Aligns specifications with documented architecture and patterns</integration>
    </usage>
    <usage>
      <mode>Dev Env</mode>
      <integration>Uses bootstrap configuration and setup patterns</integration>
    </usage>
    <usage>
      <mode>MR Actions</mode>
      <integration>Validates changes against bootstrap conventions</integration>
    </usage>
  </integration_with_modes>
</bootstrap_workflow>