<jira_integration>
  <overview>
    Complete Jira integration for project online task tracking via Atlassian MCP server,
    including task discovery, status updates, user assignment, and description enhancement.
  </overview>

  <jira_project_key_workflow>
    <reference>../../sdlc/shared/jira-project-key-workflow.md</reference>
    <description>
      MANDATORY workflow for obtaining Jira project key with .env check first.
      Environment variable loading and JQL construction patterns.
    </description>
  </jira_project_key_workflow>

  <user_identification>
    <reference>../../sdlc/shared/jira-user-identification.md</reference>
    <description>
      How to correctly identify current user for Jira operations using git config user.email.
      Critical guidance on currentUser() vs actual email for assignments.
    </description>
  </user_identification>

  <git_integration>
    <reference>../../sdlc/shared/jira-git-integration.md</reference>
    <description>
      Branch naming conventions, git commands, and Jira key extraction patterns.
    </description>
  </git_integration>

  <workflow_patterns>
    <reference>../../sdlc/shared/jira-workflow-patterns.md</reference>
    <description>
      Task discovery, assignment, description enhancement, task creation, and quick query workflows.
      MCP tool usage patterns and examples.
    </description>
  </workflow_patterns>

  <jql_patterns>
    <reference>../../sdlc/shared/jira-jql-patterns.md</reference>
    <description>
      Common JQL query patterns with substitution requirements and examples.
    </description>
  </jql_patterns>

  <automatic_status_updates>
    <reference>../../sdlc/shared/jira-status-updates.md</reference>
    <reference_file>sdlc/.roo/rules-orchestrator/5_automatic_jira_status_updates.xml</reference_file>
    <description>
      All automatic status update workflows are defined in the referenced files.
      This includes:
      - Automatic update checkpoints and triggers
      - Status transition matrix
      - Story Points validation workflow
      - Error handling and user communication
      - Integration with all modes
    </description>
  </automatic_status_updates>

  <environment_variables>
    <required>
      <variable name="JIRA_URL">Jira instance URL (e.g., https://your-domain.atlassian.net)</variable>
      <variable name="JIRA_USERNAME">Jira username/email for authentication</variable>
      <variable name="JIRA_API_TOKEN">Jira API token for authentication</variable>
    </required>
    <configuration_location>
      <path>.roo/mcp.json</path>
      <note>Credentials configured in per-project MCP settings, not in project .env file</note>
    </configuration_location>
  </environment_variables>

  <error_handling>
    <mcp_connection_failure>
      <detection>MCP Atlassian tools unavailable or return errors</detection>
      <delegation>IMMEDIATELY delegate to project online Dev Env mode for MCP troubleshooting</delegation>
      <reference>See sdlc/.roo/rules-orchestrator/3_dev_env_delegation.xml for delegation workflow</reference>
      <note>Orchestrator coordinates workflows, does NOT fix environment/MCP issues</note>
    </mcp_connection_failure>

    <missing_credentials>
      <detection>JIRA_URL, JIRA_USERNAME, or JIRA_API_TOKEN not configured in MCP settings</detection>
      <delegation>IMMEDIATELY delegate to project online Dev Env mode for MCP configuration</delegation>
      <reference>See sdlc/.roo/rules-orchestrator/3_dev_env_delegation.xml for delegation workflow</reference>
      <note>Dev Env mode handles all MCP server configuration and credential setup</note>
    </missing_credentials>

    <permission_errors>
      <detection>Jira API returns 403 Forbidden</detection>
      <response>Check user has appropriate project permissions in Jira</response>
    </permission_errors>

    <api_rate_limits>
      <detection>Jira API returns 429 Too Many Requests</detection>
      <response>Wait and retry with exponential backoff</response>
    </api_rate_limits>
  </error_handling>
</jira_integration>