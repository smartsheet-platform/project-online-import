\documentclass[11pt,letterpaper]{report}

% Packages
\usepackage[utf8]{inputenc}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{color}
\usepackage{hyperref}
\usepackage{titlesec}
\usepackage{tocloft}
\usepackage{etoolbox}
\usepackage{listings}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{enumitem}
\usepackage{array}
\usepackage{calc}

% Pandoc compatibility - define tightlist for compact lists
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% For pandoc tables
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of longtable head and foot
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines

% Colors - Smartsheet brand colors
\definecolor{smartsheetdarkblue}{RGB}{0,15,51}
\definecolor{smartsheetblue}{RGB}{0,99,190}
\definecolor{smartsheetlightgray}{RGB}{242,242,242}

% Hyperlink setup
\hypersetup{
    colorlinks=true,
    linkcolor=smartsheetblue,
    filecolor=smartsheetblue,
    urlcolor=smartsheetblue,
    citecolor=smartsheetblue,
    pdftitle={Migrating to Smartsheet from Project Online},
    pdfauthor={Smartsheet Migration Tool},
}

% Custom title page command
\newcommand{\customtitlepage}{
    \begin{titlepage}
        \centering
        \vspace*{2cm}
        
        % Smartsheet logo text (since we can't embed SVG easily)
        {\Huge\textcolor{smartsheetblue}{\textbf{Smartsheet}}\par}
        \vspace{1cm}
        
        % Background color box with title
        \begin{center}
        \colorbox{smartsheetlightgray}{
            \begin{minipage}{0.9\textwidth}
                \centering
                \vspace{1cm}
                {\Huge\textcolor{smartsheetdarkblue}{\textbf{Migrating to Smartsheet}}\par}
                \vspace{0.3cm}
                {\LARGE\textcolor{smartsheetdarkblue}{\textbf{from Project Online}}\par}
                \vspace{1cm}
            \end{minipage}
        }
        \end{center}
        
        \vspace{2cm}
        {\Large Complete Migration Guide\par}
        \vspace{0.5cm}
        {\large December 2024\par}
        
        \vfill
        
        % Footer on title page
        {\large\textcolor{smartsheetblue}{\textbf{Smartsheet}}\par}
    \end{titlepage}
}

% Chapter formatting - make chapters look like major sections
\titleformat{\chapter}[display]
{\normalfont\huge\bfseries\color{smartsheetdarkblue}}
{\chaptertitlename\ \thechapter}{20pt}{\Huge}

\titleformat{\section}
{\normalfont\Large\bfseries\color{smartsheetdarkblue}}
{\thesection}{1em}{}

\titleformat{\subsection}
{\normalfont\large\bfseries\color{smartsheetdarkblue}}
{\thesubsection}{1em}{}

% Table of contents formatting
\renewcommand{\contentsname}{\textcolor{smartsheetdarkblue}{Table of Contents}}
\renewcommand{\cftchapfont}{\bfseries\color{smartsheetdarkblue}}
\renewcommand{\cftsecfont}{\color{smartsheetdarkblue}}

% Page style
\pagestyle{fancy}
\fancyhf{}

% Header
\fancyhead[C]{\textcolor{smartsheetdarkblue}{\small Migrating to Smartsheet from Project Online}}

% Footer - page number on right, Smartsheet on left
\fancyfoot[L]{\textcolor{smartsheetblue}{\small\textbf{Smartsheet}}}
\fancyfoot[R]{\textcolor{smartsheetdarkblue}{\thepage}}

% Remove header/footer on chapter pages
\fancypagestyle{plain}{
    \fancyhf{}
    \fancyfoot[L]{\textcolor{smartsheetblue}{\small\textbf{Smartsheet}}}
    \fancyfoot[R]{\textcolor{smartsheetdarkblue}{\thepage}}
    \renewcommand{\headrulewidth}{0pt}
}

% Header rule
\renewcommand{\headrulewidth}{0.5pt}
\renewcommand{\headrule}{\hbox to\headwidth{\color{smartsheetblue}\leaders\hrule height \headrulewidth\hfill}}

% Start document
\begin{document}

% Custom title page
\customtitlepage

% Table of contents
\tableofcontents
\newpage

% Main content will be inserted here by pandoc
$body$

\end{document}