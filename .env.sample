# Project Online to Smartsheet Import Tool
# Environment Configuration
#
# Copy this file to .env and fill in your values:
#   cp .env.sample .env
#
# ============================================================================
# Configuration
# ============================================================================

# Smartsheet Configuration (required)
# ─────────────────────────────────────────────────────────────────────────
# Get your API token from: https://app.smartsheet.com/account/apps
# Required scopes: READ_SHEETS, WRITE_SHEETS, CREATE_SHEETS, DELETE_SHEETS
SMARTSHEET_API_TOKEN=

# Smartsheet API Host (optional)
# Select the appropriate regional endpoint based on your account location:
# - North America: https://api.smartsheet.com/2.0/ (default)
# - Europe: https://api.smartsheet.eu/2.0/
# - Australia: https://api.smartsheet.au/2.0/
SMARTSHEET_API_HOST=

# PMO Standards Workspace ID (optional)
# If you have an existing PMO Standards workspace, specify its ID here
# to reuse it across imports. Otherwise, a new workspace will be created.
PMO_STANDARDS_WORKSPACE_ID=

# Template Workspace Configuration
# ─────────────────────────────────────────────────────────────────────────
# Template Workspace ID (optional)
# Workspace ID used as template for creating new project workspaces
# The template should contain pre-configured sheets with all columns defined
#
# AUTOMATED SETUP (Recommended):
# Leave this blank on first run. The tool will guide you through obtaining
# the recommended template via distribution link and automatically configure
# this value.
#
# MANUAL SETUP:
# If you already have a template workspace, specify its ID here to skip
# the guided setup.
#
# Example: TEMPLATE_WORKSPACE_ID=9002412817049476
TEMPLATE_WORKSPACE_ID=

# Template Distribution Link (optional)
# Smartsheet distribution link URL for acquiring the template workspace
# Visit the project documentation for the recommended template link
TEMPLATE_DISTRIBUTION_URL=

# Template Workspace Name (optional)
# Expected name of the workspace created by the distribution link
# Used to search for and identify the newly created workspace
# Default: Project Online Migration
TEMPLATE_WORKSPACE_NAME=

# Solution Type (optional)
# Controls workspace creation strategy
# Options: StandaloneWorkspaces (default), Portfolio
# - StandaloneWorkspaces: Creates independent PMO Standards and project workspaces
# - Portfolio: Creates workspaces within a portfolio structure (future implementation)
# SOLUTION_TYPE=StandaloneWorkspaces

# Project Online Configuration (required for extraction)
# ─────────────────────────────────────────────────────────────────────────
# Azure AD Tenant ID (find in Azure Portal → Azure Active Directory → Overview)
TENANT_ID=

# Azure AD Application (Client) ID
# Create app registration at: https://portal.azure.com → Azure Active Directory
# → App registrations → New registration
CLIENT_ID=

# Project Online Site URL
# Format: https://[tenant].sharepoint.com/sites/[site-name]
# Example: https://contoso.sharepoint.com/sites/pwa
PROJECT_ONLINE_URL=

# Azure AD App Registration Setup Instructions (Device Code Flow):
# ─────────────────────────────────────────────────────────────────────────
# This tool uses Device Code Flow authentication with delegated permissions.
# You will authenticate interactively when running the tool for the first time.
# Your authentication token will be cached for future use.
#
# 1. Go to: https://portal.azure.com → Azure Active Directory
# 2. Navigate to: App registrations → New registration
# 3. Name: "Project Online ETL Tool"
# 4. Supported account types: "Accounts in this organizational directory only"
# 5. Redirect URI: Leave blank
# 6. Click "Register"
#
# 7. Copy the following from the Overview page:
#    - Application (client) ID → CLIENT_ID
#    - Directory (tenant) ID → TENANT_ID
#
# 8. Enable Public Client Flows:
#    - Go to: Authentication
#    - Under "Advanced settings" → "Allow public client flows"
#    - Set to: YES
#    - Click "Save"
#
# 9. Grant Delegated Permissions:
#    - Go to: API permissions → Add a permission
#    - Select: SharePoint → Delegated permissions
#    - Check: AllSites.Read and AllSites.Write
#    - Click: Add permissions
#    - Note: User consent will be handled during first authentication
#
# 10. Test your configuration:
#     npm run dev validate -- --source [project-id]
#     (You will be prompted to authenticate via browser on first run)

# API Retry Configuration (optional)
# ─────────────────────────────────────────────────────────────────────────
# Configure exponential backoff retry behavior for API calls
# These settings apply to both Project Online OData API and Smartsheet API
#
# Maximum number of retry attempts for failed API calls (default: 5)
# Increase for flaky networks, decrease for faster failure detection
RETRY_MAX_RETRIES=5
#
# Initial delay in milliseconds before first retry (default: 1000)
# Each subsequent retry doubles the delay (exponential backoff)
# Example: 1000ms → 2000ms → 4000ms → 8000ms → 16000ms
RETRY_INITIAL_DELAY_MS=1000